
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>Washportal Admin â€“ App Ready</title>
</head>
<body>

<h2>Admin Login</h2>
<input id="email" placeholder="Email"/>
<input id="password" type="password" placeholder="Passwort"/>
<button onclick="login()">Login</button>

<h2>Users</h2>
<button onclick="loadUsers()">Users laden</button>
<pre id="out"></pre>

<script>

let API = "";
let TOKEN = "";

function setAPI(url){
  API = url;
}

async function login(){
  const res = await fetch(API+"/api/auth/login",{
    method:"POST",
    headers:{"content-type":"application/json"},
    body:JSON.stringify({
      email:document.getElementById("email").value,
      password:document.getElementById("password").value
    })
  });
  const data = await res.json();
  TOKEN = data.token;
  localStorage.setItem("admin_token",TOKEN);
  alert("Login OK");
}

async function loadUsers(){
  const res = await fetch(API+"/api/auth/admin/users/list",{
    headers:{
      "authorization":"Bearer "+TOKEN
    }
  });
  const data = await res.json();
  document.getElementById("out").textContent = JSON.stringify(data,null,2);
}

</script>
</body>
</html>
