<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Datenschutz</title>
<style>
  :root{--bg:#070b14;--card:#121a2b;--muted:#93a4c7;--text:#e8eefc;--acc:#6aa7ff;}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#050912,#0b1220);color:var(--text)}
  header{position:sticky;top:0;background:rgba(5,9,18,.86);backdrop-filter:blur(10px);border-bottom:1px solid rgba(255,255,255,.08);padding:12px 14px}
  .wrap{max-width:900px;margin:0 auto;padding:14px;display:grid;gap:12px}
  .card{background:rgba(18,26,43,.78);border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:14px}
  h1{margin:0;font-size:16px}
  h2{margin:0 0 8px 0;font-size:16px}
  .muted{color:var(--muted)}
  a{color:var(--acc);text-decoration:none}
  .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:12px;white-space:pre-wrap;color:var(--muted)}
</style>
</head>
<body>
<header>
  <div class="wrap" style="padding:0">
    <h1>Datenschutz</h1>
  </div>
</header>
<div class="wrap">
  <div class="card">
    <div class="muted">Diese Seite l√§dt die Meta-Infos live aus dem Worker.</div>
    <div class="muted" style="margin-top:6px">Worker: <span id="workerOut" class="mono"></span></div>
  </div>

  <div class="card" id="textCard" style="display:none">
    <h2>Datenschutzerkl√§rung</h2>
    <div id="text"></div>
    <div class="muted" style="margin-top:10px">Stand: <span id="stand"></span></div>
  </div>

  <div class="card">
    <h2>Meta</h2>
    <div class="mono" id="raw"></div>
  </div>
</div>

<script>
  // üîí Privacy Worker-URL "freezed" (fixiert)
  const WORKER_URL = "https://washportal-dev-worker.schluffi1220.workers.dev";

  const $ = (id)=>document.getElementById(id);
  const pad2 = (n)=>String(n).padStart(2,"0");
  const fmtDate = (ts)=>{
    const d=new Date(ts);
    return pad2(d.getDate())+"."+pad2(d.getMonth()+1)+"."+d.getFullYear();
  };
  const escapeHtml = (s)=>String(s??"").replace(/[&<>"']/g, c=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" }[c]));
  $("workerOut").textContent = WORKER_URL;

  async function load(){
    const res = await fetch(WORKER_URL + "/api/privacy/meta");
    const j = await res.json();
    $("raw").textContent = JSON.stringify(j, null, 2);

    if(j && j.ok){
      const psName = (j.patientSpeaker && j.patientSpeaker.name) ? j.patientSpeaker.name : "‚Äî";
      const psEmail = (j.patientSpeaker && j.patientSpeaker.email) ? j.patientSpeaker.email : "‚Äî";
      const deleteAt = j.deleteAt || 0;

      const txt = `
<h3>1. Verantwortlicher</h3>
<p>Verantwortlich f√ºr die Datenverarbeitung auf dieser Website im Sinne der Datenschutz-Grundverordnung (DSGVO) ist:</p>
<p><b>${escapeHtml(psName)}</b><br/>
Salzburgweg 7, 97616 Bad Neustadt an der Saale</p>
<p>Kontakt: <b>${escapeHtml(psEmail)}</b></p>
<p>Da diese Website privat durch einen Patienten betrieben wird, besteht kein betrieblicher Datenschutzbeauftragter.</p>

<h3>2. Zweck der Website</h3>
<p>Diese Website dient ausschlie√ülich der Organisation und Buchung von Waschmaschinenzeiten innerhalb der Saaletalklinik Bad Neustadt. Sie ist nur f√ºr Patienten der Klinik bestimmt.</p>

<h3>3. Welche Daten werden verarbeitet?</h3>
<p>Bei Nutzung der Website werden folgende personenbezogene Daten verarbeitet:</p>
<ul>
<li>Zimmernummer (als Benutzerkennung)</li>
<li>selbstgew√§hlter PIN-Code</li>
<li>gebuchte Waschmaschinen-Zeiten</li>
<li>technische Zugriffsdaten (z. B. IP-Adresse, Datum und Uhrzeit des Zugriffs)</li>
</ul>
<p>Die Zimmernummer erm√∂glicht im Kontext der Klinik die Zuordnung zu einer bestimmten Person und stellt daher ein personenbezogenes Datum im Sinne von Art. 4 Nr. 1 DSGVO dar.</p>

<h3>4. Zweck der Datenverarbeitung</h3>
<p>Die Verarbeitung erfolgt ausschlie√ülich zum Zweck:</p>
<ul>
<li>der Identifikation der jeweiligen Nutzer bei der Buchung</li>
<li>der Verwaltung der Waschmaschinenbelegung</li>
<li>der technischen Bereitstellung und Sicherheit der Website</li>
</ul>
<p>Eine Nutzung der Daten zu anderen Zwecken oder eine Weitergabe an Dritte erfolgt nicht.</p>

<h3>5. Rechtsgrundlage</h3>
<p>Die Verarbeitung erfolgt auf Grundlage von Art. 6 Abs. 1 lit. f DSGVO (berechtigtes Interesse), da ohne die Verarbeitung der genannten Daten eine geordnete Buchung der Waschmaschinen nicht m√∂glich w√§re und keine √ºberwiegenden Interessen der betroffenen Personen entgegenstehen.</p>

<h3>6. Speicherung und L√∂schung</h3>
<p>Buchungsdaten werden nur so lange gespeichert, wie dies f√ºr die Organisation der Waschmaschinenbelegung erforderlich ist.</p>
<p><b>Geplantes L√∂schdatum (nach aktueller Retention): ${deleteAt ? fmtDate(deleteAt) : "‚Äî"}</b></p>
<p>Server-Logdaten (z. B. IP-Adressen) werden ausschlie√ülich aus technischen Gr√ºnden kurzfristig gespeichert und regelm√§√üig gel√∂scht.</p>

<h3>7. Datensicherheit</h3>
<p>Es werden angemessene technische Ma√ünahmen eingesetzt, um die gespeicherten Daten vor unbefugtem Zugriff zu sch√ºtzen. Ein absoluter Schutz kann jedoch bei internetbasierten Systemen nicht garantiert werden.</p>

<h3>8. Rechte der betroffenen Personen</h3>
<p>Nutzer haben jederzeit das Recht auf:</p>
<ul>
<li>Auskunft √ºber ihre gespeicherten Daten (Art. 15 DSGVO)</li>
<li>Berichtigung unrichtiger Daten (Art. 16 DSGVO)</li>
<li>L√∂schung ihrer Daten (Art. 17 DSGVO)</li>
<li>Einschr√§nkung der Verarbeitung (Art. 18 DSGVO)</li>
<li>Widerspruch gegen die Verarbeitung (Art. 21 DSGVO)</li>
</ul>
<p>Anfragen k√∂nnen an den oben genannten Verantwortlichen gerichtet werden.</p>

<h3>9. Beschwerderecht</h3>
<p>Es besteht ein Beschwerderecht bei einer Datenschutzaufsichtsbeh√∂rde, hier das Bayerisches Landesamt f√ºr Datenschutzaufsicht.</p>

<h3>10. √Ñnderungen dieser Datenschutzerkl√§rung</h3>
<p>Diese Datenschutzerkl√§rung kann angepasst werden, falls sich technische oder rechtliche √Ñnderungen ergeben.</p>
      `.trim();

      $("text").innerHTML = txt;
      $("stand").textContent = fmtDate(Date.now());
      $("textCard").style.display = "";
    }
  }
  load().catch(err=>{
    $("raw").textContent = "Fehler: " + String(err);
  });
</script>
</body>
</html>
