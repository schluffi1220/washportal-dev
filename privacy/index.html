<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Datenschutzbestimmungen</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; margin:0; background:#0b1020; color:#e9eefc;}
    a{color:inherit;}
    header{padding:18px 16px; background:linear-gradient(135deg,#15224a,#0b1020); border-bottom:1px solid rgba(255,255,255,.08);}
    .wrap{max-width:980px; margin:0 auto; padding:16px;}
    .card{background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.10); border-radius:14px; padding:16px; box-shadow:0 10px 25px rgba(0,0,0,.25);}
    .muted{opacity:.8}
    .policy{line-height:1.45}
    ul{margin:8px 0 8px 22px}
    .box{margin-top:14px; padding:12px; border-radius:12px; background:rgba(0,0,0,.25); border:1px solid rgba(255,255,255,.08);}
    input,button{font:inherit;}
    input{width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.18); background:rgba(0,0,0,.25); color:#fff;}
    button{padding:10px 12px; border-radius:10px; border:0; background:linear-gradient(135deg,#7fd6ff,#6ee7b7); color:#0b1b2b; font-weight:700; cursor:pointer;}
    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}
    .row > *{flex:1; min-width:200px;}
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;}
  </style>
</head>
<body>
<header>
  <div class="wrap">
    <div style="display:flex;justify-content:space-between;align-items:baseline;gap:12px;flex-wrap:wrap;">
      <div>
        <div style="font-size:20px;font-weight:800;">Datenschutzbestimmungen</div>
        <div class="muted">Washportal · <a href="https://schluffi1220.github.io/washportal-dev/" style="color:inherit;text-decoration:underline;font-weight:700;">
  ← Zurück zum Portal
</a>
      </div>
      <div class="muted" id="metaLine">Lade Infos…</div>
    </div>
  </div>
</header>

<main class="wrap">
  <div class="card policy">
    Datenschutzerklärung
1. Verantwortlicher
Verantwortlich für die Datenverarbeitung auf dieser Website im Sinne der Datenschutz-Grundverordnung (DSGVO) ist:
[Vor- und Nachname des Betreibers]
Salzburgweg 7, 97616 Bad Neustadt an der Saale
Kontakt: [E-Mail-Adresse oder alternative Kontaktmöglichkeit]
Da diese Website privat durch einen Patienten betrieben wird, besteht kein betrieblicher Datenschutzbeauftragter.
2. Zweck der Website
Diese Website dient ausschließlich der Organisation und Buchung von Waschmaschinenzeiten innerhalb der Saaletalklinik Bad Neustadt. Sie ist nur für Patienten der Klinik bestimmt.
3. Welche Daten werden verarbeitet?
Bei Nutzung der Website werden folgende personenbezogene Daten verarbeitet:
<ul>
<li>Zimmernummer (als Benutzerkennung)</li>
<li>selbstgewählter PIN-Code</li>
<li>gebuchte Waschmaschinen-Zeiten</li>
<li>technische Zugriffsdaten (z. B. IP-Adresse, Datum und Uhrzeit des Zugriffs)</li>
</ul>
Die Zimmernummer ermöglicht im Kontext der Klinik die Zuordnung zu einer bestimmten Person und stellt daher ein personenbezogenes Datum im Sinne von Art. 4 Nr. 1 DSGVO dar.
4. Zweck der Datenverarbeitung
Die Verarbeitung erfolgt ausschließlich zum Zweck:
<ul>
<li>der Identifikation der jeweiligen Nutzer bei der Buchung</li>
<li>der Verwaltung der Waschmaschinenbelegung</li>
<li>der technischen Bereitstellung und Sicherheit der Website</li>
</ul>
Eine Nutzung der Daten zu anderen Zwecken oder eine Weitergabe an Dritte erfolgt nicht.
<br/>
<br/>
<br/>
<br/>
5. Rechtsgrundlage
Die Verarbeitung erfolgt auf Grundlage von Art. 6 Abs. 1 lit. f DSGVO (berechtigtes Interesse), da ohne die Verarbeitung der genannten Daten eine geordnete Buchung der Waschmaschinen nicht möglich wäre und keine überwiegenden Interessen der betroffenen Personen entgegenstehen.
6. Speicherung und Löschung
Buchungsdaten werden nur so lange gespeichert, wie dies für die Organisation der Waschmaschinenbelegung erforderlich ist. [Frist?]
Server-Logdaten (z. B. IP-Adressen) werden ausschließlich aus technischen Gründen kurzfristig gespeichert und regelmäßig gelöscht.
7. Datensicherheit
Es werden angemessene technische Maßnahmen eingesetzt, um die gespeicherten Daten vor unbefugtem Zugriff zu schützen. Ein absoluter Schutz kann jedoch bei internetbasierten Systemen nicht garantiert werden.
8. Rechte der betroffenen Personen
Nutzer haben jederzeit das Recht auf:
<ul>
<li>Auskunft über ihre gespeicherten Daten (Art. 15 DSGVO)</li>
<li>Berichtigung unrichtiger Daten (Art. 16 DSGVO)</li>
<li>Löschung ihrer Daten (Art. 17 DSGVO)</li>
<li>Einschränkung der Verarbeitung (Art. 18 DSGVO)</li>
<li>Widerspruch gegen die Verarbeitung (Art. 21 DSGVO)</li>
</ul>
Anfragen können an den oben genannten Verantwortlichen gerichtet werden.
9. Beschwerderecht
Es besteht ein Beschwerderecht bei einer Datenschutzaufsichtsbehörde, hier das Bayerisches Landesamt für Datenschutzaufsicht.
10. Änderungen dieser Datenschutzerklärung
Diese Datenschutzerklärung kann angepasst werden, falls sich technische oder rechtliche Änderungen ergeben.
Stand: 27.01.2026
<br/>
<br/>

    <div class="box" id="dynDeleteBox">
      <b>Automatischer Löschzeitpunkt</b><br/>
      <span id="deleteInfo" class="muted">Lade…</span>
    </div>

    <div class="box" id="dynPsBox">
      <b>Registrierte Patientensprecher</b><br/>
      <div id="psList" class="muted">Lade…</div>
    </div>
  </div>
  </div>
</main>
<script>
const API_BASE = "https://washportal-dev-worker.schluffi1220.workers.dev";

function pad(n){return String(n).padStart(2,"0");}
function fmt(ts){
  const d=new Date(Number(ts));
  return pad(d.getDate())+"."+pad(d.getMonth()+1)+"."+d.getFullYear()+" "+pad(d.getHours())+":"+pad(d.getMinutes());
}
function esc(s){return String(s??"").replace(/[&<>"']/g, c=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;" }[c]));}

async function jget(path){
  const r = await fetch(API_BASE + path);
  const t = await r.text();
  let j={}; try{ j = t ? JSON.parse(t) : {}; } catch { j={}; }
  if(!r.ok) throw {status:r.status, data:j};
  return j;
}
async function jpost(path, data){
  const r = await fetch(API_BASE + path, {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify(data||{})
  });
  const t = await r.text();
  let j={}; try{ j = t ? JSON.parse(t) : {}; } catch { j={}; }
  if(!r.ok) throw {status:r.status, data:j};
  return j;
}

async function loadMeta(){
  const j = await jget("/api/privacy/meta");
  if(!j.ok) throw new Error("meta");
  const del = fmt(j.deleteAt || j.delete_at || Date.now());
  const metaLine = document.getElementById("metaLine");
  if(metaLine) metaLine.textContent = "Stand: " + del;

  const deleteInfo = document.getElementById("deleteInfo");
  if(deleteInfo){
    deleteInfo.innerHTML =
      "Buchungsdaten werden nur so lange gespeichert, wie dies für die Organisation erforderlich ist. "+
      "Bei der aktuellen Einstellung werden Daten spätestens am <span class='mono'>"+esc(del)+"</span> gelöscht "+
      "(Fenster: "+esc(j.daysPast)+" Tage zurück, "+esc(j.daysFuture)+" Tage voraus).";
  }

  const list = document.getElementById("psList");
  if(list){
    const ps = j.patientSpeakers || [];
    if(!ps.length){
      list.textContent = "Noch keine Registrierungen.";
    } else {
      list.innerHTML = ps.map(p=>{
        const name = p.name || [p.firstName, p.lastName].filter(Boolean).join(" ");
        const email = p.emailMasked || p.email || "";
        const st = p.status || "";
        return "• "+esc(name)+" ("+esc(email)+")"+(st?(" – "+esc(st)):"");
      }).join("<br/>");
    }
  }
}

document.addEventListener("DOMContentLoaded", ()=>{
  loadMeta().catch(()=>{ const m=document.getElementById("metaLine"); if(m) m.textContent=""; });

  const form = document.getElementById("psForm");
  const msg  = document.getElementById("psMsg");
  const btn  = document.getElementById("psSubmit");

  if(!form) return;
  form.addEventListener("submit", async (e)=>{
    e.preventDefault();
    const fn = (document.getElementById("psFirst")?.value||"").trim();
    const ln = (document.getElementById("psLast")?.value||"").trim();
    const em = (document.getElementById("psEmail")?.value||"").trim();
    const role = (document.getElementById("psRole")?.value||"ps").trim();

    if(!fn || !ln || !em){
      if(msg) msg.textContent = "⛔ Bitte alle Felder ausfüllen.";
      return;
    }

    if(btn) btn.disabled = true;
    if(msg) msg.textContent = "";

    try{
      await jpost("/api/ps/register", { firstName: fn, lastName: ln, email: em, role });
      if(msg) msg.textContent = "✅ Registrierung gespeichert (Freischaltung durch Admin).";
      form.reset();
      await loadMeta();
    }catch(err){
      console.error(err);
      const m = err?.data?.message || err?.data?.error || ("HTTP " + (err?.status || "?"));
      if(msg) msg.textContent = "⛔ " + m;
    }finally{
      if(btn) btn.disabled = false;
    }
  });
});
</script>

<!-- ===================== -->
<!-- Registrierung -->
<!-- ===================== -->
<hr style="margin:40px 0; opacity:.2">

<div class="card" style="max-width:980px;margin:0 auto 40px auto;">
  <h3 style="margin-top:0">Registrierung</h3>
  <div class="muted" style="margin-bottom:12px">
    Zugang wird durch einen Admin freigeschaltet. Danach erhältst du einen Login‑Code.
  </div>

 <form id="psForm" style="
  display:grid;
  grid-template-columns:repeat(2, minmax(0,1fr));
  gap:10px;
  align-items:stretch;
">
    <select id="psRole" required style="grid-column:1/-1;width:100%">
      <option value="ps">Patientensprecher</option>
      <option value="ps_deputy">Stellv. Patientensprecher</option>
      <option value="admin">Admin</option>
    </select>

    <input id="psFirst" placeholder="Vorname" required style="width:100%">
<input id="psLast" placeholder="Nachname" required style="width:100%">
<input id="psEmail" type="email" placeholder="E-Mail" required style="grid-column:1/-1;width:100%">

    <button id="psSubmit" type="submit" style="grid-column:1/-1;width:100%">Registrieren</button>
    <div id="psMsg" class="muted" style="grid-column:1/-1"></div>
  </form>
</div>

</body>
</html>
